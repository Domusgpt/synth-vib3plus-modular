import{_ as n}from"./index-BOP-Xn5g.js";class s{constructor(){this.currentSystem="faceted",this.userParameterState={},this.isInitialized=!1,this.setupGlobalFunctions()}setupGlobalFunctions(){window.switchSystem=async e=>{if(console.log(`ğŸ¯ switchSystem called with: ${e}`),window.canvasManager)try{console.log(`ğŸ”„ Switching to ${e} system...`);const t=await window.canvasManager.switchToSystem(e,window.engineClasses);if(t){console.log(`âœ… ${e} system ready with engine`),window.currentSystem=e,this.currentSystem=e,window.reactivityManager&&window.reactivityManager.setActiveSystem(e,t),setTimeout(()=>{window.syncVisualizerToUI?window.syncVisualizerToUI(e,t):console.warn("âš ï¸ syncVisualizerToUI function not available")},300),document.querySelectorAll(".system-btn").forEach(i=>{i.classList.toggle("active",i.dataset.system===e)});const a={faceted:"FACETED SYSTEM",quantum:"QUANTUM SYSTEM",holographic:"HOLOGRAPHIC SYSTEM",polychora:"POLYCHORA SYSTEM"},o=document.getElementById("panelHeader");o&&(o.textContent=a[e]||"VIB34D SYSTEM"),console.log(`âœ… Switched to ${e} system successfully`);return}else if(e==="polychora"){console.log("ğŸ”® Polychora system not implemented yet");return}else console.error(`âŒ ${e} engine failed to create`)}catch(t){console.error(`âŒ Failed to switch to ${e}:`,t)}console.error(`ğŸ’¥ CanvasManager failed for ${e} - system may not work properly`)},window.selectGeometry=e=>{document.querySelectorAll(".geom-btn").forEach(t=>{t.classList.toggle("active",t.dataset.index==e)}),window.updateParameter&&window.updateParameter("geometry",e)},window.userParameterState=this.userParameterState,window.enhancedUpdateParameter=(e,t)=>{this.userParameterState[e]=parseFloat(t),console.log(`ğŸ’¾ User set ${e} = ${t}`),window.originalUpdateParameter&&window.originalUpdateParameter(e,t)},window.getCurrentUIParameterState=()=>{const e=["rot4dXW","rot4dYW","rot4dZW","gridDensity","morphFactor","chaos","speed","hue","intensity","saturation"],t={};return e.forEach(a=>{if(this.userParameterState[a]!==void 0)t[a]=this.userParameterState[a];else{const o=document.getElementById(a);o&&(t[a]=parseFloat(o.value),console.log(`ğŸ“Š UI read ${a} = ${o.value} (from slider)`))}}),t},window.syncSlidersToStoredValues=()=>{console.log("ğŸ”„ Syncing sliders to stored values..."),Object.entries(this.userParameterState).forEach(([e,t])=>{var o;const a=document.getElementById(e);if(a&&!isNaN(t)){a.value=t;const i=(o=a.parentElement)==null?void 0:o.querySelector(".control-value");i&&(i.textContent=t),console.log(`ğŸ”„ Synced ${e} slider to ${t}`)}else a||console.warn(`âš ï¸ Slider not found for parameter: ${e}`)})},window.syncVisualizerToUI=(e,t)=>{console.log(`ğŸ”„ Syncing ${e} visualizer to UI state...`);const a=window.getCurrentUIParameterState();console.log("ğŸ“Š Current UI parameter state:",a),Object.entries(a).forEach(([o,i])=>{window.updateParameter&&(window.updateParameter(o,i),console.log(`âœ… Applied ${o} = ${i} to ${e}`))}),console.log(`âœ… ${e} visualizer synced to UI`)},window.toggleDeviceTilt=async()=>{if(!window.deviceTiltHandler)return console.warn("ğŸ¯ Device tilt handler not available"),!1;const e=document.getElementById("tiltBtn");return window.deviceTiltHandler.isEnabled?(window.deviceTiltHandler.disable(),e&&(e.style.background="",e.title="Device Tilt (4D Rotation)"),console.log("ğŸ¯ Device tilt disabled"),!1):await window.deviceTiltHandler.enable()?(e&&(e.style.background="linear-gradient(45deg, #00ffff, #0099ff)",e.style.color="#000",e.title="Device Tilt Active - Tilt device to control 4D rotation!"),console.log("ğŸ¯ Device tilt enabled"),!0):(console.warn("ğŸ¯ Device tilt failed to enable"),!1)},window.updateTiltBaseRotations=()=>{window.deviceTiltHandler&&this.userParameterState&&window.deviceTiltHandler.updateBaseRotation(this.userParameterState.rot4dXW||0,this.userParameterState.rot4dYW||0,this.userParameterState.rot4dZW||0)}}async initialize(){console.log("ğŸš€ Initializing VIB34D Application...");try{if(!window.canvasManager)try{console.log("ğŸ”§ Initializing CanvasManager...");const{CanvasManager:e}=await n(async()=>{const{CanvasManager:t}=await import("./CanvasManager-BT4ruED8.js");return{CanvasManager:t}},[],import.meta.url);window.canvasManager=new e,console.log("âœ… CanvasManager initialized")}catch(e){console.warn("âš ï¸ CanvasManager not available:",e.message),window.canvasManager={switchToSystem:async()=>(console.log("âš ï¸ CanvasManager stub: switchToSystem called"),null)}}if(!window.reactivityManager)try{console.log("ğŸ”§ Initializing ReactivityManager...");const{ReactivityManager:e}=await n(async()=>{const{ReactivityManager:t}=await import("./ReactivityManager-CQHKZe5v.js");return{ReactivityManager:t}},[],import.meta.url);window.reactivityManager=new e,console.log("âœ… ReactivityManager initialized")}catch(e){console.warn("âš ï¸ ReactivityManager not available:",e.message),window.reactivityManager={setActiveSystem:()=>{},setMouseMode:()=>{},toggleMouse:()=>{},setClickMode:()=>{},toggleClick:()=>{},setScrollMode:()=>{},toggleScroll:()=>{}}}this.isInitialized=!0,console.log("âœ… VIB34D Application initialized")}catch(e){throw console.error("âŒ Failed to initialize VIB34D Application:",e),e}}getCurrentSystem(){return this.currentSystem}updateParameter(e,t){this.userParameterState[e]=parseFloat(t),console.log(`ğŸ’¾ Parameter updated: ${e} = ${t}`)}getParameterState(){return{...this.userParameterState}}}export{s as VIB34DApp,s as default};
