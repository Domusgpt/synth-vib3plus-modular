class d{constructor(){this.params={variation:0,rot4dXY:0,rot4dXZ:0,rot4dYZ:0,rot4dXW:0,rot4dYW:0,rot4dZW:0,dimension:3.5,gridDensity:15,morphFactor:1,chaos:.2,speed:1,hue:200,intensity:.5,saturation:.8,geometry:0},this.parameterDefs={variation:{min:0,max:99,step:1,type:"int"},rot4dXY:{min:-6.28,max:6.28,step:.01,type:"float"},rot4dXZ:{min:-6.28,max:6.28,step:.01,type:"float"},rot4dYZ:{min:-6.28,max:6.28,step:.01,type:"float"},rot4dXW:{min:-2,max:2,step:.01,type:"float"},rot4dYW:{min:-2,max:2,step:.01,type:"float"},rot4dZW:{min:-2,max:2,step:.01,type:"float"},dimension:{min:3,max:4.5,step:.01,type:"float"},gridDensity:{min:4,max:100,step:.1,type:"float"},morphFactor:{min:0,max:2,step:.01,type:"float"},chaos:{min:0,max:1,step:.01,type:"float"},speed:{min:.1,max:3,step:.01,type:"float"},hue:{min:0,max:360,step:1,type:"int"},intensity:{min:0,max:1,step:.01,type:"float"},saturation:{min:0,max:1,step:.01,type:"float"},geometry:{min:0,max:23,step:1,type:"int"}},this.defaults={...this.params}}getAllParameters(){return{...this.params}}setParameter(t,a){if(this.parameterDefs[t]){const e=this.parameterDefs[t];return a=Math.max(e.min,Math.min(e.max,a)),e.type==="int"&&(a=Math.round(a)),this.params[t]=a,!0}return console.warn(`Unknown parameter: ${t}`),!1}setParameters(t){for(const[a,e]of Object.entries(t))this.setParameter(a,e)}getParameter(t){return this.params[t]}setGeometry(t){this.setParameter("geometry",t)}updateFromControls(){["variationSlider","rot4dXW","rot4dYW","rot4dZW","dimension","gridDensity","morphFactor","chaos","speed","hue"].forEach(a=>{const e=document.getElementById(a);if(e){const r=parseFloat(e.value);let s=a;a==="variationSlider"&&(s="variation"),this.setParameter(s,r)}})}updateDisplayValues(){this.updateSliderValue("variationSlider",this.params.variation),this.updateSliderValue("rot4dXW",this.params.rot4dXW),this.updateSliderValue("rot4dYW",this.params.rot4dYW),this.updateSliderValue("rot4dZW",this.params.rot4dZW),this.updateSliderValue("dimension",this.params.dimension),this.updateSliderValue("gridDensity",this.params.gridDensity),this.updateSliderValue("morphFactor",this.params.morphFactor),this.updateSliderValue("chaos",this.params.chaos),this.updateSliderValue("speed",this.params.speed),this.updateSliderValue("hue",this.params.hue),this.updateDisplayText("rot4dXWDisplay",this.params.rot4dXW.toFixed(2)),this.updateDisplayText("rot4dYWDisplay",this.params.rot4dYW.toFixed(2)),this.updateDisplayText("rot4dZWDisplay",this.params.rot4dZW.toFixed(2)),this.updateDisplayText("dimensionDisplay",this.params.dimension.toFixed(2)),this.updateDisplayText("gridDensityDisplay",this.params.gridDensity.toFixed(1)),this.updateDisplayText("morphFactorDisplay",this.params.morphFactor.toFixed(2)),this.updateDisplayText("chaosDisplay",this.params.chaos.toFixed(2)),this.updateDisplayText("speedDisplay",this.params.speed.toFixed(2)),this.updateDisplayText("hueDisplay",this.params.hue+"Â°"),this.updateVariationInfo(),this.updateGeometryButtons()}updateSliderValue(t,a){const e=document.getElementById(t);e&&(e.value=a)}updateDisplayText(t,a){const e=document.getElementById(t);e&&(e.textContent=a)}updateVariationInfo(){const t=document.getElementById("currentVariationDisplay");if(t){const a=["TETRAHEDRON LATTICE","HYPERCUBE LATTICE","SPHERE LATTICE","TORUS LATTICE","KLEIN BOTTLE LATTICE","FRACTAL LATTICE","WAVE LATTICE","CRYSTAL LATTICE"],e=Math.floor(this.params.variation/4),r=this.params.variation%4+1,s=a[e]||"CUSTOM VARIATION";t.textContent=`${this.params.variation+1} - ${s}`,this.params.variation<30&&(t.textContent+=` ${r}`)}}updateGeometryButtons(){document.querySelectorAll("[data-geometry]").forEach(t=>{t.classList.toggle("active",parseInt(t.dataset.geometry)===this.params.geometry)})}randomizeAll(){this.params.rot4dXY=Math.random()*12.56-6.28,this.params.rot4dXZ=Math.random()*12.56-6.28,this.params.rot4dYZ=Math.random()*12.56-6.28,this.params.rot4dXW=Math.random()*4-2,this.params.rot4dYW=Math.random()*4-2,this.params.rot4dZW=Math.random()*4-2,this.params.dimension=3+Math.random()*1.5,this.params.gridDensity=4+Math.random()*26,this.params.morphFactor=Math.random()*2,this.params.chaos=Math.random(),this.params.speed=.1+Math.random()*2.9,this.params.hue=Math.random()*360,this.params.geometry=Math.floor(Math.random()*24)}resetToDefaults(){this.params={...this.defaults}}loadConfiguration(t){if(t&&typeof t=="object"){for(const[a,e]of Object.entries(t))this.parameterDefs[a]&&this.setParameter(a,e);return!0}return!1}exportConfiguration(){return{type:"vib34d-integrated-config",version:"1.0.0",timestamp:new Date().toISOString(),name:`VIB34D Config ${new Date().toLocaleDateString()}`,parameters:{...this.params}}}generateVariationParameters(t){if(t<30){const a=Math.floor(t/4),e=t%4;return{geometry:a,gridDensity:8+e*4,morphFactor:.5+e*.3,chaos:e*.15,speed:.8+e*.2,hue:(a*45+e*15)%360,rot4dXW:(e-1.5)*.5,rot4dYW:a%2*.3,rot4dZW:(a+e)%3*.2,dimension:3.2+e*.2}}else return{...this.params}}applyVariation(t){const a=this.generateVariationParameters(t);this.setParameters(a),this.params.variation=t}getColorHSV(){return{h:this.params.hue,s:.8,v:.9}}getColorRGB(){const t=this.getColorHSV();return this.hsvToRgb(t.h,t.s,t.v)}hsvToRgb(t,a,e){t=t/60;const r=e*a,s=r*(1-Math.abs(t%2-1)),m=e-r;let i,o,n;return t<1?[i,o,n]=[r,s,0]:t<2?[i,o,n]=[s,r,0]:t<3?[i,o,n]=[0,r,s]:t<4?[i,o,n]=[0,s,r]:t<5?[i,o,n]=[s,0,r]:[i,o,n]=[r,0,s],{r:Math.round((i+m)*255),g:Math.round((o+m)*255),b:Math.round((n+m)*255)}}validateConfiguration(t){if(!t||typeof t!="object")return{valid:!1,error:"Configuration must be an object"};if(t.type!=="vib34d-integrated-config")return{valid:!1,error:"Invalid configuration type"};if(!t.parameters)return{valid:!1,error:"Missing parameters object"};for(const[a,e]of Object.entries(t.parameters))if(this.parameterDefs[a]){const r=this.parameterDefs[a];if(typeof e!="number"||e<r.min||e>r.max)return{valid:!1,error:`Invalid value for parameter ${a}: ${e}`}}return{valid:!0}}}export{d as P};
